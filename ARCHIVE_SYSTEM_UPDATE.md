# نظام أرشفة الطلبيات

## الميزات الجديدة

### 1. حالة "مؤرشفة" للطلبيات
- إضافة حالة جديدة `archived` للطلبيات
- زر الأرشفة يظهر فقط للطلبيات المسلمة (`delivered`)
- لون بنفسجي مميز للطلبيات المؤرشفة

### 2. نظام الأرشفة الاحترافي
- تجميع الطلبيات المؤرشفة حسب الشهر والسنة
- واجهة مجلدات قابلة للطي والفتح
- عرض عدد الطلبيات في كل مجلد
- بحث في الأرشيف

### 3. صفحة الأرشيف المخصصة
- صفحة منفصلة لعرض الأرشيف
- تصميم احترافي مع مجلدات تفاعلية
- إمكانية عرض تفاصيل وطباعة الطلبيات المؤرشفة

## الملفات المُحدثة

### النماذج
- `app/Models/Order.php`: إضافة دوال الأرشفة والتحقق

### المتحكمات
- `app/Http/Controllers/OrderController.php`: إضافة دوال الأرشفة وصفحة الأرشيف

### ملفات العرض
- `resources/views/orders/index.blade.php`: زر الأرشفة وتبويب الأرشيف
- `resources/views/orders/edit.blade.php`: خيار الحالة المؤرشفة
- `resources/views/orders/show.blade.php`: عرض الحالة المؤرشفة
- `resources/views/orders/archives.blade.php`: صفحة الأرشيف الجديدة
- `resources/views/dashboard.blade.php`: رابط الأرشيف

### الأنماط والتصميم
- `public/css/style.css`: أنماط الحالة المؤرشفة وزر الأرشفة

### قاعدة البيانات
- `database/migrations/2025_01_15_000002_add_archived_status_to_orders.php`

### المسارات
- `routes/web.php`: مسارات الأرشفة الجديدة

## كيفية الاستخدام

### 1. أرشفة طلبية
- الطلبية يجب أن تكون في حالة "تم التسليم"
- اضغط على زر الأرشيف (أيقونة الأرشيف)
- تأكيد الأرشفة

### 2. عرض الأرشيف
- من الصفحة الرئيسية: اضغط على "أرشيف الطلبيات"
- أو من تبويب "مؤرشفة" في صفحة الطلبيات
- اضغط على المجلد لعرض الطلبيات

### 3. البحث في الأرشيف
- استخدم مربع البحث في صفحة الأرشيف
- البحث يشمل رقم الطلبية واسم العميل ونوع الطلبية

## الألوان والتصميم

- **مؤرشفة**: بنفسجي (#8b5cf6)
- **مجلدات الأرشيف**: تدرج بنفسجي
- **زر الأرشفة**: خلفية بنفسجية فاتحة

## المميزات التقنية

### 1. التجميع الذكي
```php
$archives = $query->latest()->get()->groupBy('archive_folder');
```

### 2. تنسيق التاريخ العربي
```php
\Carbon\Carbon::createFromFormat('Y-m', $folder)->locale('ar')->translatedFormat('F Y')
```

### 3. التحقق من إمكانية الأرشفة
```php
public function canBeArchived()
{
    return $this->status === 'delivered';
}
```

### 4. مجلد الأرشيف التلقائي
```php
public function getArchiveFolderAttribute()
{
    return $this->order_date->format('Y-m');
}
```

## تشغيل التحديث

```bash
php artisan migrate
```

## ملاحظات مهمة

1. **الأمان**: فقط الطلبيات المسلمة يمكن أرشفتها
2. **التنظيم**: الطلبيات تُجمع حسب شهر وسنة تاريخ الطلبية
3. **المرونة**: يمكن البحث والعرض والطباعة للطلبيات المؤرشفة
4. **الأداء**: التجميع يتم على مستوى التطبيق لمرونة أكبر

## إضافات مستقبلية محتملة

- إحصائيات الأرشيف
- تصدير الأرشيف
- أرشفة تلقائية بعد فترة معينة
- ضغط الأرشيف القديم